{"version":3,"sources":["../src/index.ts","../src/NavLink.tsx"],"sourcesContent":["// src/index.ts\n\n// Components\nexport { NavLink } from \"./NavLink\";\nexport type { NavLinkProps } from \"./NavLink\";\n\nexport { NavigationProgress } from \"./NavLink\";\nexport { useNavigate } from \"./NavLink\";\n","// src/lib/nav-progress/index.tsx\n\"use client\";\n\nimport Link from \"next/link\";\nimport { usePathname, useRouter } from \"next/navigation\";\nimport React, { useEffect, useState } from \"react\";\n\n// --------------------\n// Types\n// --------------------\n\nexport interface NavLinkProps\n  extends Omit<React.AnchorHTMLAttributes<HTMLAnchorElement>, \"href\"> {\n  href: string;\n  exact?: boolean;\n  activeClassName?: string;\n  className?: string;\n  children: React.ReactNode;\n}\n\n// --------------------\n// NavProgressManager\n// --------------------\n\ntype ProgressCallback = () => void;\n\nclass NavProgressManager {\n  private startListeners: ProgressCallback[] = [];\n  private finishListeners: ProgressCallback[] = [];\n\n  start() {\n    this.startListeners.forEach((cb) => cb());\n  }\n\n  finish() {\n    this.finishListeners.forEach((cb) => cb());\n  }\n\n  onStart(cb: ProgressCallback) {\n    this.startListeners.push(cb);\n  }\n\n  onFinish(cb: ProgressCallback) {\n    this.finishListeners.push(cb);\n  }\n}\n\nconst progressManager = new NavProgressManager();\n\n// --------------------\n// Helper constants/functions for NavLink\n// --------------------\n\nconst EXTERNAL_LINK_REGEX = /^(https?:)?\\/\\//;\nconst DEFAULT_CLASSES =\n  \"inline-flex items-center gap-2 px-3 py-2 rounded-md transition-colors duration-200 focus:outline-none\";\nconst DEFAULT_ACTIVE_CLASSES =\n  \"text-sky-600 font-semibold bg-sky-50 dark:bg-sky-950/20\";\n\nconst normalizePath = (path: string): string => {\n  if (!path || path === \"/\") return \"/\";\n  return path.endsWith(\"/\") ? path.slice(0, -1) : path;\n};\n\nconst isExternalLink = (href: string): boolean =>\n  EXTERNAL_LINK_REGEX.test(href);\n\nconst getPathnameFromExternalUrl = (url: string): string => {\n  try {\n    return new URL(url).pathname;\n  } catch {\n    return url;\n  }\n};\n\n// --------------------\n// NavLink Component\n// --------------------\n\nexport function NavLink({\n  href,\n  exact = false,\n  activeClassName = DEFAULT_ACTIVE_CLASSES,\n  className = DEFAULT_CLASSES,\n  children,\n  ...rest\n}: NavLinkProps) {\n  const pathname = usePathname();\n  const router = useRouter();\n\n  const isExternal = React.useMemo(() => isExternalLink(href), [href]);\n\n  const isActive = React.useMemo(() => {\n    if (!pathname || isExternal) return false;\n\n    const currentPath = normalizePath(pathname);\n    const targetPath = href.startsWith(\"/\")\n      ? normalizePath(href)\n      : normalizePath(getPathnameFromExternalUrl(href));\n\n    if (exact) return currentPath === targetPath;\n\n    if (targetPath === \"/\") return currentPath === \"/\";\n\n    return (\n      currentPath === targetPath || currentPath.startsWith(targetPath + \"/\")\n    );\n  }, [pathname, href, exact, isExternal]);\n\n  const mergedClassName = React.useMemo(() => {\n    const baseClasses = [className];\n    if (isActive && pathname !== null) baseClasses.push(activeClassName);\n    return baseClasses.filter(Boolean).join(\" \").trim();\n  }, [className, isActive, activeClassName, pathname]);\n\n  const handleClick = (e: React.MouseEvent<HTMLAnchorElement>) => {\n    if (isExternal) return; // external links behave normally\n    if (e.metaKey || e.ctrlKey || e.shiftKey || e.altKey || e.button === 1)\n      return;\n    e.preventDefault();\n    if (pathname === href) return;\n    progressManager.start();\n    router.push(href);\n  };\n\n  const ariaAttributes = React.useMemo(() => {\n    const attributes: {\n      \"aria-current\"?: \"page\" | undefined;\n      \"aria-label\"?: string;\n    } = {\n      \"aria-current\": isActive ? \"page\" : undefined,\n    };\n\n    if (rest[\"aria-label\"]) {\n      attributes[\"aria-label\"] = rest[\"aria-label\"];\n    }\n\n    return attributes;\n  }, [isActive, rest]);\n\n  return (\n    <Link\n      href={href}\n      className={mergedClassName}\n      {...ariaAttributes}\n      {...rest}\n      onClick={handleClick}\n      prefetch={true}\n    >\n      {children}\n    </Link>\n  );\n}\n\nNavLink.displayName = \"NavLink\";\n\n// --------------------\n// useNavigate Hook\n// --------------------\n\nexport const useNavigate = () => {\n  const router = useRouter();\n  const pathname = usePathname();\n\n  const navigate = (\n    href: string,\n    options?: { replace?: boolean; scroll?: boolean }\n  ) => {\n    if (pathname === href) return;\n    progressManager.start();\n    const { replace = false, scroll = true } = options || {};\n    if (replace) router.replace(href, { scroll });\n    else router.push(href, { scroll });\n  };\n\n  return navigate;\n};\n\n// --------------------\n// NavigationProgress Component\n// --------------------\n\nexport const NavigationProgress: React.FC<{\n  color?: string;\n  height?: string;\n  duration?: number;\n}> = ({ color = \"#2563EB\", height = \"3px\", duration = 200 }) => {\n  const [width, setWidth] = useState(\"0%\");\n  const [visible, setVisible] = useState(false);\n  const pathname = usePathname();\n\n  useEffect(() => {\n    progressManager.onStart(() => {\n      setVisible(true);\n      setWidth(\"0%\");\n      setTimeout(() => setWidth(\"40%\"), 10);\n    });\n\n    progressManager.onFinish(() => {\n      setWidth(\"100%\");\n      setTimeout(() => {\n        setVisible(false);\n        setWidth(\"0%\");\n      }, duration + 50);\n    });\n  }, [duration]);\n\n  useEffect(() => {\n    progressManager.finish();\n  }, [pathname]);\n\n  if (!visible) return null;\n\n  return (\n    <div\n      style={{\n        width,\n        height,\n        backgroundColor: color,\n        transition: `width ${duration}ms ease`,\n      }}\n      className=\"fixed top-0 left-0 z-[99999]\"\n    />\n  );\n};\n"],"mappings":"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","names":["React","Link"]}